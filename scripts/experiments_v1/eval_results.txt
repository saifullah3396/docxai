{'image_attr_analysis': <class 'xai_torch.analyzer.feature_attr_analysis.image_attr_analysis.ImageAttrAnalysis'>, 'generate_metrics': <class 'xai_torch.analyzer.generate_metrics.GenerateMetrics'>}
2023-03-21 05:27:20 serv-9205 xai_torch[1094634] INFO Running task: evaluation
2023-03-21 05:27:20 serv-9205 xai_torch[1094634] INFO PyTorch version: 1.13.1+cu1160
2023-03-21 05:27:20 serv-9205 xai_torch[1094634] INFO Ignite version: 0.4.100
2023-03-21 05:27:21 serv-9205 xai_torch[1094634] INFO GPU Device: NVIDIA TITAN V
2023-03-21 05:27:21 serv-9205 xai_torch[1094634] INFO CUDA version: 11.6
2023-03-21 05:27:21 serv-9205 xai_torch[1094634] INFO CUDNN version: 8302
2023-03-21 05:27:21 serv-9205 xai_torch[1094634] INFO Initializing training script with the following arguments:
2023-03-21 05:27:21 serv-9205 xai_torch[1094634] INFO Global seed set to 42
2023-03-21 05:27:21 serv-9205 xai_torch[1094634] INFO Setting output directory: /netscratch/saifullah/xai_torch/docxai/evaluation/rvlcdip/timm_model_dpn107
2023-03-21 05:27:21 serv-9205 xai_torch[1094634] INFO Loading data for stage == test
2023-03-21 05:27:21 serv-9205 xai_torch[1094634] INFO Loading dataset [rvlcdip-test] from cache.
2023-03-21 05:27:21 serv-9205 xai_torch[1094634] INFO [rvlcdip-test] Defining data transformations:
image:
 Compose(
    GrayScaleToRGB()
    Rescale(size=[224, 224], interpolation='bilinear', max_size=None, antialias=False)
    ConvertImageDtype()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2023-03-21 05:27:21 serv-9205 xai_torch[1094634] INFO Test set size = 39999
2023-03-21 05:27:21 serv-9205 xai_torch[1094634] INFO Testing model [baseline]
2023-03-21 05:27:21 serv-9205 xai_torch[1094634] INFO Initialized the model with data labels: ['letter', 'form', 'email', 'handwritten', 'advertisement', 'scientific report', 'scientific publication', 'specification', 'file folder', 'news article', 'budgetv', 'invoice', 'presentation', 'questionnaire', 'resume', 'memo']
2023-03-21 05:27:21 serv-9205 xai_torch[1094634] INFO Loading model from checkpoint file [/netscratch/saifullah/resources/pretrained_models/rvlcdip/dpn107.pt] with strict [True]
checkpoint dict_keys(['state_dict'])
2023-03-21 05:27:25 serv-9205 xai_torch[1094634] INFO ===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
TimmModelForImageClassification                    --
├─DPN: 1-1                                         --
│    └─Sequential: 2-1                             --
│    │    └─ConvBnAct: 3-1                         19,072
│    │    └─MaxPool2d: 3-2                         --
│    │    └─DualPathBlock: 3-3                     127,200
│    │    └─DualPathBlock: 3-4                     127,032
│    │    └─DualPathBlock: 3-5                     131,072
│    │    └─DualPathBlock: 3-6                     135,112
│    │    └─DualPathBlock: 3-7                     653,344
│    │    └─DualPathBlock: 3-8                     543,808
│    │    └─DualPathBlock: 3-9                     569,536
│    │    └─DualPathBlock: 3-10                    595,264
│    │    └─DualPathBlock: 3-11                    620,992
│    │    └─DualPathBlock: 3-12                    646,720
│    │    └─DualPathBlock: 3-13                    672,448
│    │    └─DualPathBlock: 3-14                    698,176
│    │    └─DualPathBlock: 3-15                    3,242,112
│    │    └─DualPathBlock: 3-16                    1,964,032
│    │    └─DualPathBlock: 3-17                    2,015,360
│    │    └─DualPathBlock: 3-18                    2,066,688
│    │    └─DualPathBlock: 3-19                    2,118,016
│    │    └─DualPathBlock: 3-20                    2,169,344
│    │    └─DualPathBlock: 3-21                    2,220,672
│    │    └─DualPathBlock: 3-22                    2,272,000
│    │    └─DualPathBlock: 3-23                    2,323,328
│    │    └─DualPathBlock: 3-24                    2,374,656
│    │    └─DualPathBlock: 3-25                    2,425,984
│    │    └─DualPathBlock: 3-26                    2,477,312
│    │    └─DualPathBlock: 3-27                    2,528,640
│    │    └─DualPathBlock: 3-28                    2,579,968
│    │    └─DualPathBlock: 3-29                    2,631,296
│    │    └─DualPathBlock: 3-30                    2,682,624
│    │    └─DualPathBlock: 3-31                    2,733,952
│    │    └─DualPathBlock: 3-32                    2,785,280
│    │    └─DualPathBlock: 3-33                    2,836,608
│    │    └─DualPathBlock: 3-34                    2,887,936
│    │    └─DualPathBlock: 3-35                    13,453,056
│    │    └─DualPathBlock: 3-36                    7,844,864
│    │    └─DualPathBlock: 3-37                    8,049,920
│    │    └─CatBnAct: 3-38                         5,376
│    └─SelectAdaptivePool2d: 2-2                   --
│    │    └─Identity: 3-39                         --
│    │    └─AdaptiveAvgPool2d: 3-40                --
│    └─Conv2d: 2-3                                 43,024
│    └─Flatten: 2-4                                --
├─CrossEntropyLoss: 1-2                            --
├─CrossEntropyLoss: 1-3                            --
===========================================================================
Total params: 84,271,824
Trainable params: 84,271,824
Non-trainable params: 0
===========================================================================
2023-03-21 05:27:25 serv-9205 xai_torch[1094634] INFO Engine run starting with max_epochs=1.
2023-03-21 05:31:20 serv-9205 xai_torch[1094634] INFO
Epoch 1 - Evaluation time (seconds): 0.00 - test metrics:
        test/loss: 0.3573417663574219
        last/test/accuracy: 0.8922973074326859
2023-03-21 05:31:20 serv-9205 xai_torch[1094634] INFO Epoch[1] Complete. Time taken: 00:03:55.318
2023-03-21 05:31:20 serv-9205 xai_torch[1094634] INFO Engine run complete. Time taken: 00:03:55.570
{'image_attr_analysis': <class 'xai_torch.analyzer.feature_attr_analysis.image_attr_analysis.ImageAttrAnalysis'>, 'generate_metrics': <class 'xai_torch.analyzer.generate_metrics.GenerateMetrics'>}
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO Running task: evaluation
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO PyTorch version: 1.13.1+cu1160
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO Ignite version: 0.4.100
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO GPU Device: NVIDIA TITAN V
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO CUDA version: 11.6
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO CUDNN version: 8302
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO Initializing training script with the following arguments:
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO Global seed set to 42
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO Setting output directory: /netscratch/saifullah/xai_torch/docxai/evaluation/rvlcdip/timm_model_mobilenetv3_large_100
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO Loading data for stage == test
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO Loading dataset [rvlcdip-test] from cache.
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO [rvlcdip-test] Defining data transformations:
image:
 Compose(
    GrayScaleToRGB()
    Rescale(size=[224, 224], interpolation='bilinear', max_size=None, antialias=False)
    ConvertImageDtype()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO Test set size = 39999
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO Testing model [baseline]
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO Initialized the model with data labels: ['letter', 'form', 'email', 'handwritten', 'advertisement', 'scientific report', 'scientific publication', 'specification', 'file folder', 'news article', 'budgetv', 'invoice', 'presentation', 'questionnaire', 'resume', 'memo']
2023-03-21 05:31:31 serv-9205 xai_torch[1094979] INFO Loading model from checkpoint file [/netscratch/saifullah/resources/pretrained_models/rvlcdip/mobilenetv3_large_100.pt] with strict [True]
checkpoint dict_keys(['state_dict'])
2023-03-21 05:31:34 serv-9205 xai_torch[1094979] INFO ===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
TimmModelForImageClassification                    --
├─MobileNetV3: 1-1                                 --
│    └─Conv2d: 2-1                                 432
│    └─BatchNorm2d: 2-2                            32
│    └─Hardswish: 2-3                              --
│    └─Sequential: 2-4                             --
│    │    └─Sequential: 3-1                        464
│    │    └─Sequential: 3-2                        7,880
│    │    └─Sequential: 3-3                        52,312
│    │    └─Sequential: 3-4                        130,824
│    │    └─Sequential: 3-5                        600,544
│    │    └─Sequential: 3-6                        2,023,944
│    │    └─Sequential: 3-7                        155,520
│    └─SelectAdaptivePool2d: 2-5                   --
│    │    └─Identity: 3-8                          --
│    │    └─AdaptiveAvgPool2d: 3-9                 --
│    └─Conv2d: 2-6                                 1,230,080
│    └─Hardswish: 2-7                              --
│    └─Flatten: 2-8                                --
│    └─Linear: 2-9                                 20,496
├─CrossEntropyLoss: 1-2                            --
├─CrossEntropyLoss: 1-3                            --
===========================================================================
Total params: 4,222,528
Trainable params: 4,222,528
Non-trainable params: 0
===========================================================================
2023-03-21 05:31:34 serv-9205 xai_torch[1094979] INFO Engine run starting with max_epochs=1.
2023-03-21 05:32:01 serv-9205 xai_torch[1094979] INFO
Epoch 1 - Evaluation time (seconds): 0.00 - test metrics:
        test/loss: 0.43782997131347656
        last/test/accuracy: 0.8756968924223105
2023-03-21 05:32:01 serv-9205 xai_torch[1094979] INFO Epoch[1] Complete. Time taken: 00:00:27.207
2023-03-21 05:32:01 serv-9205 xai_torch[1094979] INFO Engine run complete. Time taken: 00:00:27.430
{'image_attr_analysis': <class 'xai_torch.analyzer.feature_attr_analysis.image_attr_analysis.ImageAttrAnalysis'>, 'generate_metrics': <class 'xai_torch.analyzer.generate_metrics.GenerateMetrics'>}
2023-03-21 05:32:12 serv-9205 xai_torch[1095240] INFO Running task: evaluation
2023-03-21 05:32:12 serv-9205 xai_torch[1095240] INFO PyTorch version: 1.13.1+cu1160
2023-03-21 05:32:12 serv-9205 xai_torch[1095240] INFO Ignite version: 0.4.100
2023-03-21 05:32:12 serv-9205 xai_torch[1095240] INFO GPU Device: NVIDIA TITAN V
2023-03-21 05:32:12 serv-9205 xai_torch[1095240] INFO CUDA version: 11.6
2023-03-21 05:32:12 serv-9205 xai_torch[1095240] INFO CUDNN version: 8302
2023-03-21 05:32:12 serv-9205 xai_torch[1095240] INFO Initializing training script with the following arguments:
2023-03-21 05:32:12 serv-9205 xai_torch[1095240] INFO Global seed set to 42
2023-03-21 05:32:12 serv-9205 xai_torch[1095240] INFO Setting output directory: /netscratch/saifullah/xai_torch/docxai/evaluation/rvlcdip/timm_model_res2net101_26w_4s
2023-03-21 05:32:12 serv-9205 xai_torch[1095240] INFO Loading data for stage == test
2023-03-21 05:32:12 serv-9205 xai_torch[1095240] INFO Loading dataset [rvlcdip-test] from cache.
2023-03-21 05:32:12 serv-9205 xai_torch[1095240] INFO [rvlcdip-test] Defining data transformations:
image:
 Compose(
    GrayScaleToRGB()
    Rescale(size=[224, 224], interpolation='bilinear', max_size=None, antialias=False)
    ConvertImageDtype()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2023-03-21 05:32:12 serv-9205 xai_torch[1095240] INFO Test set size = 39999
2023-03-21 05:32:12 serv-9205 xai_torch[1095240] INFO Testing model [baseline]
2023-03-21 05:32:12 serv-9205 xai_torch[1095240] INFO Initialized the model with data labels: ['letter', 'form', 'email', 'handwritten', 'advertisement', 'scientific report', 'scientific publication', 'specification', 'file folder', 'news article', 'budgetv', 'invoice', 'presentation', 'questionnaire', 'resume', 'memo']
2023-03-21 05:32:13 serv-9205 xai_torch[1095240] INFO Loading model from checkpoint file [/netscratch/saifullah/resources/pretrained_models/rvlcdip/res2net101_26w_4s.pt] with strict [True]
checkpoint dict_keys(['state_dict'])
2023-03-21 05:32:17 serv-9205 xai_torch[1095240] INFO ======================================================================
Layer (type:depth-idx)                        Param #
======================================================================
TimmModelForImageClassification               --
├─ResNet: 1-1                                 --
│    └─Conv2d: 2-1                            9,408
│    └─BatchNorm2d: 2-2                       128
│    └─ReLU: 2-3                              --
│    └─MaxPool2d: 2-4                         --
│    └─Sequential: 2-5                        --
│    │    └─Bottle2neck: 3-1                  69,304
│    │    └─Bottle2neck: 3-2                  72,376
│    │    └─Bottle2neck: 3-3                  72,376
│    └─Sequential: 2-6                        --
│    │    └─Bottle2neck: 3-4                  366,600
│    │    └─Bottle2neck: 3-5                  287,752
│    │    └─Bottle2neck: 3-6                  287,752
│    │    └─Bottle2neck: 3-7                  287,752
│    └─Sequential: 2-7                        --
│    │    └─Bottle2neck: 3-8                  1,460,848
│    │    └─Bottle2neck: 3-9                  1,147,504
│    │    └─Bottle2neck: 3-10                 1,147,504
│    │    └─Bottle2neck: 3-11                 1,147,504
│    │    └─Bottle2neck: 3-12                 1,147,504
│    │    └─Bottle2neck: 3-13                 1,147,504
│    │    └─Bottle2neck: 3-14                 1,147,504
│    │    └─Bottle2neck: 3-15                 1,147,504
│    │    └─Bottle2neck: 3-16                 1,147,504
│    │    └─Bottle2neck: 3-17                 1,147,504
│    │    └─Bottle2neck: 3-18                 1,147,504
│    │    └─Bottle2neck: 3-19                 1,147,504
│    │    └─Bottle2neck: 3-20                 1,147,504
│    │    └─Bottle2neck: 3-21                 1,147,504
│    │    └─Bottle2neck: 3-22                 1,147,504
│    │    └─Bottle2neck: 3-23                 1,147,504
│    │    └─Bottle2neck: 3-24                 1,147,504
│    │    └─Bottle2neck: 3-25                 1,147,504
│    │    └─Bottle2neck: 3-26                 1,147,504
│    │    └─Bottle2neck: 3-27                 1,147,504
│    │    └─Bottle2neck: 3-28                 1,147,504
│    │    └─Bottle2neck: 3-29                 1,147,504
│    │    └─Bottle2neck: 3-30                 1,147,504
│    └─Sequential: 2-8                        --
│    │    └─Bottle2neck: 3-31                 5,832,288
│    │    └─Bottle2neck: 3-32                 4,583,008
│    │    └─Bottle2neck: 3-33                 4,583,008
│    └─SelectAdaptivePool2d: 2-9              --
│    │    └─Flatten: 3-34                     --
│    │    └─AdaptiveAvgPool2d: 3-35           --
│    └─Linear: 2-10                           32,784
├─CrossEntropyLoss: 1-2                       --
├─CrossEntropyLoss: 1-3                       --
======================================================================
Total params: 43,190,472
Trainable params: 43,190,472
Non-trainable params: 0
======================================================================
2023-03-21 05:32:17 serv-9205 xai_torch[1095240] INFO Engine run starting with max_epochs=1.
2023-03-21 05:33:59 serv-9205 xai_torch[1095240] INFO
Epoch 1 - Evaluation time (seconds): 0.00 - test metrics:
        test/loss: 0.39179983735084534
        last/test/accuracy: 0.8901972549313732
2023-03-21 05:33:59 serv-9205 xai_torch[1095240] INFO Epoch[1] Complete. Time taken: 00:01:41.525
2023-03-21 05:33:59 serv-9205 xai_torch[1095240] INFO Engine run complete. Time taken: 00:01:41.743
./scripts/experiments/evaluate_all.sh: line 8: ]]: command not found
{'image_attr_analysis': <class 'xai_torch.analyzer.feature_attr_analysis.image_attr_analysis.ImageAttrAnalysis'>, 'generate_metrics': <class 'xai_torch.analyzer.generate_metrics.GenerateMetrics'>}
2023-03-21 05:34:09 serv-9205 xai_torch[1095544] INFO Running task: evaluation
2023-03-21 05:34:09 serv-9205 xai_torch[1095544] INFO PyTorch version: 1.13.1+cu1160
2023-03-21 05:34:09 serv-9205 xai_torch[1095544] INFO Ignite version: 0.4.100
2023-03-21 05:34:10 serv-9205 xai_torch[1095544] INFO GPU Device: NVIDIA TITAN V
2023-03-21 05:34:10 serv-9205 xai_torch[1095544] INFO CUDA version: 11.6
2023-03-21 05:34:10 serv-9205 xai_torch[1095544] INFO CUDNN version: 8302
2023-03-21 05:34:10 serv-9205 xai_torch[1095544] INFO Initializing training script with the following arguments:
2023-03-21 05:34:10 serv-9205 xai_torch[1095544] INFO Global seed set to 42
2023-03-21 05:34:10 serv-9205 xai_torch[1095544] INFO Setting output directory: /netscratch/saifullah/xai_torch/docxai/evaluation/rvlcdip/timm_model_res2net50_26w_8s
2023-03-21 05:34:10 serv-9205 xai_torch[1095544] INFO Loading data for stage == test
2023-03-21 05:34:10 serv-9205 xai_torch[1095544] INFO Loading dataset [rvlcdip-test] from cache.
2023-03-21 05:34:10 serv-9205 xai_torch[1095544] INFO [rvlcdip-test] Defining data transformations:
image:
 Compose(
    GrayScaleToRGB()
    Rescale(size=[224, 224], interpolation='bilinear', max_size=None, antialias=False)
    ConvertImageDtype()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2023-03-21 05:34:10 serv-9205 xai_torch[1095544] INFO Test set size = 39999
2023-03-21 05:34:10 serv-9205 xai_torch[1095544] INFO Testing model [baseline]
2023-03-21 05:34:10 serv-9205 xai_torch[1095544] INFO Initialized the model with data labels: ['letter', 'form', 'email', 'handwritten', 'advertisement', 'scientific report', 'scientific publication', 'specification', 'file folder', 'news article', 'budgetv', 'invoice', 'presentation', 'questionnaire', 'resume', 'memo']
2023-03-21 05:34:10 serv-9205 xai_torch[1095544] INFO Loading model from checkpoint file [/netscratch/saifullah/resources/pretrained_models/rvlcdip/res2net50_26w_8s.pt] with strict [True]
checkpoint dict_keys(['state_dict'])
2023-03-21 05:34:14 serv-9205 xai_torch[1095544] INFO ======================================================================
Layer (type:depth-idx)                        Param #
======================================================================
TimmModelForImageClassification               --
├─ResNet: 1-1                                 --
│    └─Conv2d: 2-1                            9,408
│    └─BatchNorm2d: 2-2                       128
│    └─ReLU: 2-3                              --
│    └─MaxPool2d: 2-4                         --
│    └─Sequential: 2-5                        --
│    │    └─Bottle2neck: 3-1                  127,336
│    │    └─Bottle2neck: 3-2                  150,376
│    │    └─Bottle2neck: 3-3                  150,376
│    └─Sequential: 2-6                        --
│    │    └─Bottle2neck: 3-4                  624,520
│    │    └─Bottle2neck: 3-5                  598,920
│    │    └─Bottle2neck: 3-6                  598,920
│    │    └─Bottle2neck: 3-7                  598,920
│    └─Sequential: 2-7                        --
│    │    └─Bottle2neck: 3-8                  2,490,864
│    │    └─Bottle2neck: 3-9                  2,390,512
│    │    └─Bottle2neck: 3-10                 2,390,512
│    │    └─Bottle2neck: 3-11                 2,390,512
│    │    └─Bottle2neck: 3-12                 2,390,512
│    │    └─Bottle2neck: 3-13                 2,390,512
│    └─Sequential: 2-8                        --
│    │    └─Bottle2neck: 3-14                 9,949,024
│    │    └─Bottle2neck: 3-15                 9,551,712
│    │    └─Bottle2neck: 3-16                 9,551,712
│    └─SelectAdaptivePool2d: 2-9              --
│    │    └─Flatten: 3-17                     --
│    │    └─AdaptiveAvgPool2d: 3-18           --
│    └─Linear: 2-10                           32,784
├─CrossEntropyLoss: 1-2                       --
├─CrossEntropyLoss: 1-3                       --
======================================================================
Total params: 46,387,560
Trainable params: 46,387,560
Non-trainable params: 0
======================================================================
2023-03-21 05:34:14 serv-9205 xai_torch[1095544] INFO Engine run starting with max_epochs=1.
2023-03-21 05:35:54 serv-9205 xai_torch[1095544] INFO
Epoch 1 - Evaluation time (seconds): 0.00 - test metrics:
        test/loss: 0.3764006793498993
        last/test/accuracy: 0.8896722418060452
2023-03-21 05:35:54 serv-9205 xai_torch[1095544] INFO Epoch[1] Complete. Time taken: 00:01:39.883
2023-03-21 05:35:54 serv-9205 xai_torch[1095544] INFO Engine run complete. Time taken: 00:01:40.122
{'image_attr_analysis': <class 'xai_torch.analyzer.feature_attr_analysis.image_attr_analysis.ImageAttrAnalysis'>, 'generate_metrics': <class 'xai_torch.analyzer.generate_metrics.GenerateMetrics'>}
2023-03-21 05:36:05 serv-9205 xai_torch[1095846] INFO Running task: evaluation
2023-03-21 05:36:05 serv-9205 xai_torch[1095846] INFO PyTorch version: 1.13.1+cu1160
2023-03-21 05:36:05 serv-9205 xai_torch[1095846] INFO Ignite version: 0.4.100
2023-03-21 05:36:05 serv-9205 xai_torch[1095846] INFO GPU Device: NVIDIA TITAN V
2023-03-21 05:36:05 serv-9205 xai_torch[1095846] INFO CUDA version: 11.6
2023-03-21 05:36:05 serv-9205 xai_torch[1095846] INFO CUDNN version: 8302
2023-03-21 05:36:05 serv-9205 xai_torch[1095846] INFO Initializing training script with the following arguments:
2023-03-21 05:36:05 serv-9205 xai_torch[1095846] INFO Global seed set to 42
2023-03-21 05:36:05 serv-9205 xai_torch[1095846] INFO Setting output directory: /netscratch/saifullah/xai_torch/docxai/evaluation/rvlcdip/timm_model_res2netres2next50
2023-03-21 05:36:05 serv-9205 xai_torch[1095846] INFO Loading data for stage == test
2023-03-21 05:36:05 serv-9205 xai_torch[1095846] INFO Loading dataset [rvlcdip-test] from cache.
2023-03-21 05:36:05 serv-9205 xai_torch[1095846] INFO [rvlcdip-test] Defining data transformations:
image:
 Compose(
    GrayScaleToRGB()
    Rescale(size=[224, 224], interpolation='bilinear', max_size=None, antialias=False)
    ConvertImageDtype()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2023-03-21 05:36:05 serv-9205 xai_torch[1095846] INFO Test set size = 39999
2023-03-21 05:36:05 serv-9205 xai_torch[1095846] INFO Testing model [baseline]
2023-03-21 05:36:05 serv-9205 xai_torch[1095846] INFO Initialized the model with data labels: ['letter', 'form', 'email', 'handwritten', 'advertisement', 'scientific report', 'scientific publication', 'specification', 'file folder', 'news article', 'budgetv', 'invoice', 'presentation', 'questionnaire', 'resume', 'memo']
ERROR:root:Unknown model (res2netres2next50)
Traceback (most recent call last):
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/analyzer/analyzer.py", line 56, in run
    cls.analyze(args)
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/analyzer/analyzer.py", line 40, in analyze
    task.run()
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/analyzer/generate_metrics.py", line 65, in run
    model = self._trainer_base.setup_model(
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/training/trainer_base.py", line 1061, in setup_model
    model = ModelFactory.create(args, checkpoint=checkpoint, tb_logger=tb_logger, gt_metadata=gt_metadata, strict=strict)
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/factory.py", line 67, in create
    model = wrapper_class(args=args, model_class=model_class, **model_kwargs)
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/xai_model.py", line 94, in __init__
    self._torch_model.build_model()
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/base.py", line 68, in build_model
    self._build_model()
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/image_base.py", line 50, in _build_model
    self.model = self.load_model(
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/models/timm_model/model.py", line 24, in load_model
    return load_model_from_online_repository(
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/utilities/general.py", line 28, in load_model_from_online_repository
    model = timm.create_model(model_name, pretrained=pretrained, num_classes=num_labels, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/timm/models/factory.py", line 71, in create_model
    raise RuntimeError('Unknown model (%s)' % model_name)
RuntimeError: Unknown model (res2netres2next50)
{'image_attr_analysis': <class 'xai_torch.analyzer.feature_attr_analysis.image_attr_analysis.ImageAttrAnalysis'>, 'generate_metrics': <class 'xai_torch.analyzer.generate_metrics.GenerateMetrics'>}
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO Running task: evaluation
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO PyTorch version: 1.13.1+cu1160
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO Ignite version: 0.4.100
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO GPU Device: NVIDIA TITAN V
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO CUDA version: 11.6
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO CUDNN version: 8302
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO Initializing training script with the following arguments:
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO Global seed set to 42
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO Setting output directory: /netscratch/saifullah/xai_torch/docxai/evaluation/rvlcdip/timm_model_resnet18
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO Loading data for stage == test
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO Loading dataset [rvlcdip-test] from cache.
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO [rvlcdip-test] Defining data transformations:
image:
 Compose(
    GrayScaleToRGB()
    Rescale(size=[224, 224], interpolation='bilinear', max_size=None, antialias=False)
    ConvertImageDtype()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO Test set size = 39999
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO Testing model [baseline]
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO Initialized the model with data labels: ['letter', 'form', 'email', 'handwritten', 'advertisement', 'scientific report', 'scientific publication', 'specification', 'file folder', 'news article', 'budgetv', 'invoice', 'presentation', 'questionnaire', 'resume', 'memo']
2023-03-21 05:36:14 serv-9205 xai_torch[1095885] INFO Loading model from checkpoint file [/netscratch/saifullah/resources/pretrained_models/rvlcdip/resnet18.pt] with strict [True]
checkpoint dict_keys(['state_dict'])
2023-03-21 05:36:17 serv-9205 xai_torch[1095885] INFO ======================================================================
Layer (type:depth-idx)                        Param #
======================================================================
TimmModelForImageClassification               --
├─ResNet: 1-1                                 --
│    └─Conv2d: 2-1                            9,408
│    └─BatchNorm2d: 2-2                       128
│    └─ReLU: 2-3                              --
│    └─MaxPool2d: 2-4                         --
│    └─Sequential: 2-5                        --
│    │    └─BasicBlock: 3-1                   73,984
│    │    └─BasicBlock: 3-2                   73,984
│    └─Sequential: 2-6                        --
│    │    └─BasicBlock: 3-3                   230,144
│    │    └─BasicBlock: 3-4                   295,424
│    └─Sequential: 2-7                        --
│    │    └─BasicBlock: 3-5                   919,040
│    │    └─BasicBlock: 3-6                   1,180,672
│    └─Sequential: 2-8                        --
│    │    └─BasicBlock: 3-7                   3,673,088
│    │    └─BasicBlock: 3-8                   4,720,640
│    └─SelectAdaptivePool2d: 2-9              --
│    │    └─Flatten: 3-9                      --
│    │    └─AdaptiveAvgPool2d: 3-10           --
│    └─Linear: 2-10                           8,208
├─CrossEntropyLoss: 1-2                       --
├─CrossEntropyLoss: 1-3                       --
======================================================================
Total params: 11,184,720
Trainable params: 11,184,720
Non-trainable params: 0
======================================================================
2023-03-21 05:36:17 serv-9205 xai_torch[1095885] INFO Engine run starting with max_epochs=1.
2023-03-21 05:36:44 serv-9205 xai_torch[1095885] INFO
Epoch 1 - Evaluation time (seconds): 0.00 - test metrics:
        test/loss: 0.40381938219070435
        last/test/accuracy: 0.8859971499287482
2023-03-21 05:36:44 serv-9205 xai_torch[1095885] INFO Epoch[1] Complete. Time taken: 00:00:27.046
2023-03-21 05:36:44 serv-9205 xai_torch[1095885] INFO Engine run complete. Time taken: 00:00:27.268
{'image_attr_analysis': <class 'xai_torch.analyzer.feature_attr_analysis.image_attr_analysis.ImageAttrAnalysis'>, 'generate_metrics': <class 'xai_torch.analyzer.generate_metrics.GenerateMetrics'>}
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO Running task: evaluation
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO PyTorch version: 1.13.1+cu1160
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO Ignite version: 0.4.100
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO GPU Device: NVIDIA TITAN V
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO CUDA version: 11.6
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO CUDNN version: 8302
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO Initializing training script with the following arguments:
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO Global seed set to 42
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO Setting output directory: /netscratch/saifullah/xai_torch/docxai/evaluation/rvlcdip/timm_model_resnet34
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO Loading data for stage == test
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO Loading dataset [rvlcdip-test] from cache.
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO [rvlcdip-test] Defining data transformations:
image:
 Compose(
    GrayScaleToRGB()
    Rescale(size=[224, 224], interpolation='bilinear', max_size=None, antialias=False)
    ConvertImageDtype()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO Test set size = 39999
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO Testing model [baseline]
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO Initialized the model with data labels: ['letter', 'form', 'email', 'handwritten', 'advertisement', 'scientific report', 'scientific publication', 'specification', 'file folder', 'news article', 'budgetv', 'invoice', 'presentation', 'questionnaire', 'resume', 'memo']
2023-03-21 05:36:55 serv-9205 xai_torch[1096152] INFO Loading model from checkpoint file [/netscratch/saifullah/resources/pretrained_models/rvlcdip/resnet34.pt] with strict [True]
checkpoint dict_keys(['state_dict'])
2023-03-21 05:36:58 serv-9205 xai_torch[1096152] INFO ======================================================================
Layer (type:depth-idx)                        Param #
======================================================================
TimmModelForImageClassification               --
├─ResNet: 1-1                                 --
│    └─Conv2d: 2-1                            9,408
│    └─BatchNorm2d: 2-2                       128
│    └─ReLU: 2-3                              --
│    └─MaxPool2d: 2-4                         --
│    └─Sequential: 2-5                        --
│    │    └─BasicBlock: 3-1                   73,984
│    │    └─BasicBlock: 3-2                   73,984
│    │    └─BasicBlock: 3-3                   73,984
│    └─Sequential: 2-6                        --
│    │    └─BasicBlock: 3-4                   230,144
│    │    └─BasicBlock: 3-5                   295,424
│    │    └─BasicBlock: 3-6                   295,424
│    │    └─BasicBlock: 3-7                   295,424
│    └─Sequential: 2-7                        --
│    │    └─BasicBlock: 3-8                   919,040
│    │    └─BasicBlock: 3-9                   1,180,672
│    │    └─BasicBlock: 3-10                  1,180,672
│    │    └─BasicBlock: 3-11                  1,180,672
│    │    └─BasicBlock: 3-12                  1,180,672
│    │    └─BasicBlock: 3-13                  1,180,672
│    └─Sequential: 2-8                        --
│    │    └─BasicBlock: 3-14                  3,673,088
│    │    └─BasicBlock: 3-15                  4,720,640
│    │    └─BasicBlock: 3-16                  4,720,640
│    └─SelectAdaptivePool2d: 2-9              --
│    │    └─Flatten: 3-17                     --
│    │    └─AdaptiveAvgPool2d: 3-18           --
│    └─Linear: 2-10                           8,208
├─CrossEntropyLoss: 1-2                       --
├─CrossEntropyLoss: 1-3                       --
======================================================================
Total params: 21,292,880
Trainable params: 21,292,880
Non-trainable params: 0
======================================================================
2023-03-21 05:36:58 serv-9205 xai_torch[1096152] INFO Engine run starting with max_epochs=1.
2023-03-21 05:37:25 serv-9205 xai_torch[1096152] INFO
Epoch 1 - Evaluation time (seconds): 0.00 - test metrics:
        test/loss: 0.45113605260849
        last/test/accuracy: 0.8918972974324358
2023-03-21 05:37:25 serv-9205 xai_torch[1096152] INFO Epoch[1] Complete. Time taken: 00:00:26.658
2023-03-21 05:37:25 serv-9205 xai_torch[1096152] INFO Engine run complete. Time taken: 00:00:26.893
{'image_attr_analysis': <class 'xai_torch.analyzer.feature_attr_analysis.image_attr_analysis.ImageAttrAnalysis'>, 'generate_metrics': <class 'xai_torch.analyzer.generate_metrics.GenerateMetrics'>}
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO Running task: evaluation
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO PyTorch version: 1.13.1+cu1160
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO Ignite version: 0.4.100
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO GPU Device: NVIDIA TITAN V
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO CUDA version: 11.6
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO CUDNN version: 8302
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO Initializing training script with the following arguments:
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO Global seed set to 42
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO Setting output directory: /netscratch/saifullah/xai_torch/docxai/evaluation/rvlcdip/timm_model_resnet50
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO Loading data for stage == test
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO Loading dataset [rvlcdip-test] from cache.
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO [rvlcdip-test] Defining data transformations:
image:
 Compose(
    GrayScaleToRGB()
    Rescale(size=[224, 224], interpolation='bilinear', max_size=None, antialias=False)
    ConvertImageDtype()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO Test set size = 39999
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO Testing model [baseline]
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO Initialized the model with data labels: ['letter', 'form', 'email', 'handwritten', 'advertisement', 'scientific report', 'scientific publication', 'specification', 'file folder', 'news article', 'budgetv', 'invoice', 'presentation', 'questionnaire', 'resume', 'memo']
2023-03-21 05:37:36 serv-9205 xai_torch[1096440] INFO Loading model from checkpoint file [/netscratch/saifullah/resources/pretrained_models/rvlcdip/resnet50.pt] with strict [True]
checkpoint dict_keys(['state_dict'])
2023-03-21 05:37:39 serv-9205 xai_torch[1096440] INFO ======================================================================
Layer (type:depth-idx)                        Param #
======================================================================
TimmModelForImageClassification               --
├─ResNet: 1-1                                 --
│    └─Conv2d: 2-1                            9,408
│    └─BatchNorm2d: 2-2                       128
│    └─ReLU: 2-3                              --
│    └─MaxPool2d: 2-4                         --
│    └─Sequential: 2-5                        --
│    │    └─Bottleneck: 3-1                   75,008
│    │    └─Bottleneck: 3-2                   70,400
│    │    └─Bottleneck: 3-3                   70,400
│    └─Sequential: 2-6                        --
│    │    └─Bottleneck: 3-4                   379,392
│    │    └─Bottleneck: 3-5                   280,064
│    │    └─Bottleneck: 3-6                   280,064
│    │    └─Bottleneck: 3-7                   280,064
│    └─Sequential: 2-7                        --
│    │    └─Bottleneck: 3-8                   1,512,448
│    │    └─Bottleneck: 3-9                   1,117,184
│    │    └─Bottleneck: 3-10                  1,117,184
│    │    └─Bottleneck: 3-11                  1,117,184
│    │    └─Bottleneck: 3-12                  1,117,184
│    │    └─Bottleneck: 3-13                  1,117,184
│    └─Sequential: 2-8                        --
│    │    └─Bottleneck: 3-14                  6,039,552
│    │    └─Bottleneck: 3-15                  4,462,592
│    │    └─Bottleneck: 3-16                  4,462,592
│    └─SelectAdaptivePool2d: 2-9              --
│    │    └─Flatten: 3-17                     --
│    │    └─AdaptiveAvgPool2d: 3-18           --
│    └─Linear: 2-10                           32,784
├─CrossEntropyLoss: 1-2                       --
├─CrossEntropyLoss: 1-3                       --
======================================================================
Total params: 23,540,816
Trainable params: 23,540,816
Non-trainable params: 0
======================================================================
2023-03-21 05:37:39 serv-9205 xai_torch[1096440] INFO Engine run starting with max_epochs=1.
2023-03-21 05:38:27 serv-9205 xai_torch[1096440] INFO
Epoch 1 - Evaluation time (seconds): 0.00 - test metrics:
        test/loss: 0.4337046146392822
        last/test/accuracy: 0.882072051801295
2023-03-21 05:38:27 serv-9205 xai_torch[1096440] INFO Epoch[1] Complete. Time taken: 00:00:47.803
2023-03-21 05:38:27 serv-9205 xai_torch[1096440] INFO Engine run complete. Time taken: 00:00:48.028
{'image_attr_analysis': <class 'xai_torch.analyzer.feature_attr_analysis.image_attr_analysis.ImageAttrAnalysis'>, 'generate_metrics': <class 'xai_torch.analyzer.generate_metrics.GenerateMetrics'>}
2023-03-21 05:38:38 serv-9205 xai_torch[1096714] INFO Running task: evaluation
2023-03-21 05:38:38 serv-9205 xai_torch[1096714] INFO PyTorch version: 1.13.1+cu1160
2023-03-21 05:38:38 serv-9205 xai_torch[1096714] INFO Ignite version: 0.4.100
2023-03-21 05:38:38 serv-9205 xai_torch[1096714] INFO GPU Device: NVIDIA TITAN V
2023-03-21 05:38:38 serv-9205 xai_torch[1096714] INFO CUDA version: 11.6
2023-03-21 05:38:38 serv-9205 xai_torch[1096714] INFO CUDNN version: 8302
2023-03-21 05:38:38 serv-9205 xai_torch[1096714] INFO Initializing training script with the following arguments:
2023-03-21 05:38:38 serv-9205 xai_torch[1096714] INFO Global seed set to 42
2023-03-21 05:38:38 serv-9205 xai_torch[1096714] INFO Setting output directory: /netscratch/saifullah/xai_torch/docxai/evaluation/rvlcdip/timm_model_resnet101
2023-03-21 05:38:38 serv-9205 xai_torch[1096714] INFO Loading data for stage == test
2023-03-21 05:38:38 serv-9205 xai_torch[1096714] INFO Loading dataset [rvlcdip-test] from cache.
2023-03-21 05:38:38 serv-9205 xai_torch[1096714] INFO [rvlcdip-test] Defining data transformations:
image:
 Compose(
    GrayScaleToRGB()
    Rescale(size=[224, 224], interpolation='bilinear', max_size=None, antialias=False)
    ConvertImageDtype()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2023-03-21 05:38:38 serv-9205 xai_torch[1096714] INFO Test set size = 39999
2023-03-21 05:38:38 serv-9205 xai_torch[1096714] INFO Testing model [baseline]
2023-03-21 05:38:38 serv-9205 xai_torch[1096714] INFO Initialized the model with data labels: ['letter', 'form', 'email', 'handwritten', 'advertisement', 'scientific report', 'scientific publication', 'specification', 'file folder', 'news article', 'budgetv', 'invoice', 'presentation', 'questionnaire', 'resume', 'memo']
2023-03-21 05:38:39 serv-9205 xai_torch[1096714] INFO Loading model from checkpoint file [/netscratch/saifullah/resources/pretrained_models/rvlcdip/resnet101.pt] with strict [True]
checkpoint dict_keys(['state_dict'])
2023-03-21 05:38:43 serv-9205 xai_torch[1096714] INFO ======================================================================
Layer (type:depth-idx)                        Param #
======================================================================
TimmModelForImageClassification               --
├─ResNet: 1-1                                 --
│    └─Conv2d: 2-1                            9,408
│    └─BatchNorm2d: 2-2                       128
│    └─ReLU: 2-3                              --
│    └─MaxPool2d: 2-4                         --
│    └─Sequential: 2-5                        --
│    │    └─Bottleneck: 3-1                   75,008
│    │    └─Bottleneck: 3-2                   70,400
│    │    └─Bottleneck: 3-3                   70,400
│    └─Sequential: 2-6                        --
│    │    └─Bottleneck: 3-4                   379,392
│    │    └─Bottleneck: 3-5                   280,064
│    │    └─Bottleneck: 3-6                   280,064
│    │    └─Bottleneck: 3-7                   280,064
│    └─Sequential: 2-7                        --
│    │    └─Bottleneck: 3-8                   1,512,448
│    │    └─Bottleneck: 3-9                   1,117,184
│    │    └─Bottleneck: 3-10                  1,117,184
│    │    └─Bottleneck: 3-11                  1,117,184
│    │    └─Bottleneck: 3-12                  1,117,184
│    │    └─Bottleneck: 3-13                  1,117,184
│    │    └─Bottleneck: 3-14                  1,117,184
│    │    └─Bottleneck: 3-15                  1,117,184
│    │    └─Bottleneck: 3-16                  1,117,184
│    │    └─Bottleneck: 3-17                  1,117,184
│    │    └─Bottleneck: 3-18                  1,117,184
│    │    └─Bottleneck: 3-19                  1,117,184
│    │    └─Bottleneck: 3-20                  1,117,184
│    │    └─Bottleneck: 3-21                  1,117,184
│    │    └─Bottleneck: 3-22                  1,117,184
│    │    └─Bottleneck: 3-23                  1,117,184
│    │    └─Bottleneck: 3-24                  1,117,184
│    │    └─Bottleneck: 3-25                  1,117,184
│    │    └─Bottleneck: 3-26                  1,117,184
│    │    └─Bottleneck: 3-27                  1,117,184
│    │    └─Bottleneck: 3-28                  1,117,184
│    │    └─Bottleneck: 3-29                  1,117,184
│    │    └─Bottleneck: 3-30                  1,117,184
│    └─Sequential: 2-8                        --
│    │    └─Bottleneck: 3-31                  6,039,552
│    │    └─Bottleneck: 3-32                  4,462,592
│    │    └─Bottleneck: 3-33                  4,462,592
│    └─SelectAdaptivePool2d: 2-9              --
│    │    └─Flatten: 3-34                     --
│    │    └─AdaptiveAvgPool2d: 3-35           --
│    └─Linear: 2-10                           32,784
├─CrossEntropyLoss: 1-2                       --
├─CrossEntropyLoss: 1-3                       --
======================================================================
Total params: 42,532,944
Trainable params: 42,532,944
Non-trainable params: 0
======================================================================
2023-03-21 05:38:43 serv-9205 xai_torch[1096714] INFO Engine run starting with max_epochs=1.
2023-03-21 05:39:59 serv-9205 xai_torch[1096714] INFO
Epoch 1 - Evaluation time (seconds): 0.00 - test metrics:
        test/loss: 0.37221041321754456
        last/test/accuracy: 0.888347208680217
2023-03-21 05:39:59 serv-9205 xai_torch[1096714] INFO Epoch[1] Complete. Time taken: 00:01:15.974
2023-03-21 05:39:59 serv-9205 xai_torch[1096714] INFO Engine run complete. Time taken: 00:01:16.211
{'image_attr_analysis': <class 'xai_torch.analyzer.feature_attr_analysis.image_attr_analysis.ImageAttrAnalysis'>, 'generate_metrics': <class 'xai_torch.analyzer.generate_metrics.GenerateMetrics'>}
2023-03-21 05:40:10 serv-9205 xai_torch[1096990] INFO Running task: evaluation
2023-03-21 05:40:10 serv-9205 xai_torch[1096990] INFO PyTorch version: 1.13.1+cu1160
2023-03-21 05:40:10 serv-9205 xai_torch[1096990] INFO Ignite version: 0.4.100
2023-03-21 05:40:10 serv-9205 xai_torch[1096990] INFO GPU Device: NVIDIA TITAN V
2023-03-21 05:40:10 serv-9205 xai_torch[1096990] INFO CUDA version: 11.6
2023-03-21 05:40:10 serv-9205 xai_torch[1096990] INFO CUDNN version: 8302
2023-03-21 05:40:10 serv-9205 xai_torch[1096990] INFO Initializing training script with the following arguments:
2023-03-21 05:40:10 serv-9205 xai_torch[1096990] INFO Global seed set to 42
2023-03-21 05:40:10 serv-9205 xai_torch[1096990] INFO Setting output directory: /netscratch/saifullah/xai_torch/docxai/evaluation/rvlcdip/timm_model_resnet152
2023-03-21 05:40:10 serv-9205 xai_torch[1096990] INFO Loading data for stage == test
2023-03-21 05:40:10 serv-9205 xai_torch[1096990] INFO Loading dataset [rvlcdip-test] from cache.
2023-03-21 05:40:10 serv-9205 xai_torch[1096990] INFO [rvlcdip-test] Defining data transformations:
image:
 Compose(
    GrayScaleToRGB()
    Rescale(size=[224, 224], interpolation='bilinear', max_size=None, antialias=False)
    ConvertImageDtype()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2023-03-21 05:40:10 serv-9205 xai_torch[1096990] INFO Test set size = 39999
2023-03-21 05:40:10 serv-9205 xai_torch[1096990] INFO Testing model [baseline]
2023-03-21 05:40:10 serv-9205 xai_torch[1096990] INFO Initialized the model with data labels: ['letter', 'form', 'email', 'handwritten', 'advertisement', 'scientific report', 'scientific publication', 'specification', 'file folder', 'news article', 'budgetv', 'invoice', 'presentation', 'questionnaire', 'resume', 'memo']
2023-03-21 05:40:11 serv-9205 xai_torch[1096990] INFO Loading model from checkpoint file [/netscratch/saifullah/resources/pretrained_models/rvlcdip/resnet152.pt] with strict [True]
checkpoint dict_keys(['state_dict'])
2023-03-21 05:40:15 serv-9205 xai_torch[1096990] INFO ======================================================================
Layer (type:depth-idx)                        Param #
======================================================================
TimmModelForImageClassification               --
├─ResNet: 1-1                                 --
│    └─Conv2d: 2-1                            9,408
│    └─BatchNorm2d: 2-2                       128
│    └─ReLU: 2-3                              --
│    └─MaxPool2d: 2-4                         --
│    └─Sequential: 2-5                        --
│    │    └─Bottleneck: 3-1                   75,008
│    │    └─Bottleneck: 3-2                   70,400
│    │    └─Bottleneck: 3-3                   70,400
│    └─Sequential: 2-6                        --
│    │    └─Bottleneck: 3-4                   379,392
│    │    └─Bottleneck: 3-5                   280,064
│    │    └─Bottleneck: 3-6                   280,064
│    │    └─Bottleneck: 3-7                   280,064
│    │    └─Bottleneck: 3-8                   280,064
│    │    └─Bottleneck: 3-9                   280,064
│    │    └─Bottleneck: 3-10                  280,064
│    │    └─Bottleneck: 3-11                  280,064
│    └─Sequential: 2-7                        --
│    │    └─Bottleneck: 3-12                  1,512,448
│    │    └─Bottleneck: 3-13                  1,117,184
│    │    └─Bottleneck: 3-14                  1,117,184
│    │    └─Bottleneck: 3-15                  1,117,184
│    │    └─Bottleneck: 3-16                  1,117,184
│    │    └─Bottleneck: 3-17                  1,117,184
│    │    └─Bottleneck: 3-18                  1,117,184
│    │    └─Bottleneck: 3-19                  1,117,184
│    │    └─Bottleneck: 3-20                  1,117,184
│    │    └─Bottleneck: 3-21                  1,117,184
│    │    └─Bottleneck: 3-22                  1,117,184
│    │    └─Bottleneck: 3-23                  1,117,184
│    │    └─Bottleneck: 3-24                  1,117,184
│    │    └─Bottleneck: 3-25                  1,117,184
│    │    └─Bottleneck: 3-26                  1,117,184
│    │    └─Bottleneck: 3-27                  1,117,184
│    │    └─Bottleneck: 3-28                  1,117,184
│    │    └─Bottleneck: 3-29                  1,117,184
│    │    └─Bottleneck: 3-30                  1,117,184
│    │    └─Bottleneck: 3-31                  1,117,184
│    │    └─Bottleneck: 3-32                  1,117,184
│    │    └─Bottleneck: 3-33                  1,117,184
│    │    └─Bottleneck: 3-34                  1,117,184
│    │    └─Bottleneck: 3-35                  1,117,184
│    │    └─Bottleneck: 3-36                  1,117,184
│    │    └─Bottleneck: 3-37                  1,117,184
│    │    └─Bottleneck: 3-38                  1,117,184
│    │    └─Bottleneck: 3-39                  1,117,184
│    │    └─Bottleneck: 3-40                  1,117,184
│    │    └─Bottleneck: 3-41                  1,117,184
│    │    └─Bottleneck: 3-42                  1,117,184
│    │    └─Bottleneck: 3-43                  1,117,184
│    │    └─Bottleneck: 3-44                  1,117,184
│    │    └─Bottleneck: 3-45                  1,117,184
│    │    └─Bottleneck: 3-46                  1,117,184
│    │    └─Bottleneck: 3-47                  1,117,184
│    └─Sequential: 2-8                        --
│    │    └─Bottleneck: 3-48                  6,039,552
│    │    └─Bottleneck: 3-49                  4,462,592
│    │    └─Bottleneck: 3-50                  4,462,592
│    └─SelectAdaptivePool2d: 2-9              --
│    │    └─Flatten: 3-51                     --
│    │    └─AdaptiveAvgPool2d: 3-52           --
│    └─Linear: 2-10                           32,784
├─CrossEntropyLoss: 1-2                       --
├─CrossEntropyLoss: 1-3                       --
======================================================================
Total params: 58,176,592
Trainable params: 58,176,592
Non-trainable params: 0
======================================================================
2023-03-21 05:40:15 serv-9205 xai_torch[1096990] INFO Engine run starting with max_epochs=1.
2023-03-21 05:42:05 serv-9205 xai_torch[1096990] INFO
Epoch 1 - Evaluation time (seconds): 0.00 - test metrics:
        test/loss: 0.3757278323173523
        last/test/accuracy: 0.8856721418035451
2023-03-21 05:42:05 serv-9205 xai_torch[1096990] INFO Epoch[1] Complete. Time taken: 00:01:49.145
2023-03-21 05:42:05 serv-9205 xai_torch[1096990] INFO Engine run complete. Time taken: 00:01:49.363
{'image_attr_analysis': <class 'xai_torch.analyzer.feature_attr_analysis.image_attr_analysis.ImageAttrAnalysis'>, 'generate_metrics': <class 'xai_torch.analyzer.generate_metrics.GenerateMetrics'>}
2023-03-21 05:42:15 serv-9205 xai_torch[1097286] INFO Running task: evaluation
2023-03-21 05:42:15 serv-9205 xai_torch[1097286] INFO PyTorch version: 1.13.1+cu1160
2023-03-21 05:42:15 serv-9205 xai_torch[1097286] INFO Ignite version: 0.4.100
2023-03-21 05:42:16 serv-9205 xai_torch[1097286] INFO GPU Device: NVIDIA TITAN V
2023-03-21 05:42:16 serv-9205 xai_torch[1097286] INFO CUDA version: 11.6
2023-03-21 05:42:16 serv-9205 xai_torch[1097286] INFO CUDNN version: 8302
2023-03-21 05:42:16 serv-9205 xai_torch[1097286] INFO Initializing training script with the following arguments:
2023-03-21 05:42:16 serv-9205 xai_torch[1097286] INFO Global seed set to 42
2023-03-21 05:42:16 serv-9205 xai_torch[1097286] INFO Setting output directory: /netscratch/saifullah/xai_torch/docxai/evaluation/rvlcdip/timm_model_resnet50_32x4d
2023-03-21 05:42:16 serv-9205 xai_torch[1097286] INFO Loading data for stage == test
2023-03-21 05:42:16 serv-9205 xai_torch[1097286] INFO Loading dataset [rvlcdip-test] from cache.
2023-03-21 05:42:16 serv-9205 xai_torch[1097286] INFO [rvlcdip-test] Defining data transformations:
image:
 Compose(
    GrayScaleToRGB()
    Rescale(size=[224, 224], interpolation='bilinear', max_size=None, antialias=False)
    ConvertImageDtype()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2023-03-21 05:42:16 serv-9205 xai_torch[1097286] INFO Test set size = 39999
2023-03-21 05:42:16 serv-9205 xai_torch[1097286] INFO Testing model [baseline]
2023-03-21 05:42:16 serv-9205 xai_torch[1097286] INFO Initialized the model with data labels: ['letter', 'form', 'email', 'handwritten', 'advertisement', 'scientific report', 'scientific publication', 'specification', 'file folder', 'news article', 'budgetv', 'invoice', 'presentation', 'questionnaire', 'resume', 'memo']
ERROR:root:Unknown model (resnet50_32x4d)
Traceback (most recent call last):
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/analyzer/analyzer.py", line 56, in run
    cls.analyze(args)
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/analyzer/analyzer.py", line 40, in analyze
    task.run()
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/analyzer/generate_metrics.py", line 65, in run
    model = self._trainer_base.setup_model(
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/training/trainer_base.py", line 1061, in setup_model
    model = ModelFactory.create(args, checkpoint=checkpoint, tb_logger=tb_logger, gt_metadata=gt_metadata, strict=strict)
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/factory.py", line 67, in create
    model = wrapper_class(args=args, model_class=model_class, **model_kwargs)
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/xai_model.py", line 94, in __init__
    self._torch_model.build_model()
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/base.py", line 68, in build_model
    self._build_model()
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/image_base.py", line 50, in _build_model
    self.model = self.load_model(
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/models/timm_model/model.py", line 24, in load_model
    return load_model_from_online_repository(
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/utilities/general.py", line 28, in load_model_from_online_repository
    model = timm.create_model(model_name, pretrained=pretrained, num_classes=num_labels, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/timm/models/factory.py", line 71, in create_model
    raise RuntimeError('Unknown model (%s)' % model_name)
RuntimeError: Unknown model (resnet50_32x4d)
{'image_attr_analysis': <class 'xai_torch.analyzer.feature_attr_analysis.image_attr_analysis.ImageAttrAnalysis'>, 'generate_metrics': <class 'xai_torch.analyzer.generate_metrics.GenerateMetrics'>}
2023-03-21 05:42:25 serv-9205 xai_torch[1097333] INFO Running task: evaluation
2023-03-21 05:42:25 serv-9205 xai_torch[1097333] INFO PyTorch version: 1.13.1+cu1160
2023-03-21 05:42:25 serv-9205 xai_torch[1097333] INFO Ignite version: 0.4.100
2023-03-21 05:42:25 serv-9205 xai_torch[1097333] INFO GPU Device: NVIDIA TITAN V
2023-03-21 05:42:25 serv-9205 xai_torch[1097333] INFO CUDA version: 11.6
2023-03-21 05:42:25 serv-9205 xai_torch[1097333] INFO CUDNN version: 8302
2023-03-21 05:42:25 serv-9205 xai_torch[1097333] INFO Initializing training script with the following arguments:
2023-03-21 05:42:25 serv-9205 xai_torch[1097333] INFO Global seed set to 42
2023-03-21 05:42:25 serv-9205 xai_torch[1097333] INFO Setting output directory: /netscratch/saifullah/xai_torch/docxai/evaluation/rvlcdip/timm_model_resnet_bitv2_101x1_bitm
2023-03-21 05:42:25 serv-9205 xai_torch[1097333] INFO Loading data for stage == test
2023-03-21 05:42:25 serv-9205 xai_torch[1097333] INFO Loading dataset [rvlcdip-test] from cache.
2023-03-21 05:42:25 serv-9205 xai_torch[1097333] INFO [rvlcdip-test] Defining data transformations:
image:
 Compose(
    GrayScaleToRGB()
    Rescale(size=[224, 224], interpolation='bilinear', max_size=None, antialias=False)
    ConvertImageDtype()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2023-03-21 05:42:25 serv-9205 xai_torch[1097333] INFO Test set size = 39999
2023-03-21 05:42:25 serv-9205 xai_torch[1097333] INFO Testing model [baseline]
2023-03-21 05:42:25 serv-9205 xai_torch[1097333] INFO Initialized the model with data labels: ['letter', 'form', 'email', 'handwritten', 'advertisement', 'scientific report', 'scientific publication', 'specification', 'file folder', 'news article', 'budgetv', 'invoice', 'presentation', 'questionnaire', 'resume', 'memo']
ERROR:root:Unknown model (resnet_bitv2_101x1_bitm)
Traceback (most recent call last):
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/analyzer/analyzer.py", line 56, in run
    cls.analyze(args)
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/analyzer/analyzer.py", line 40, in analyze
    task.run()
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/analyzer/generate_metrics.py", line 65, in run
    model = self._trainer_base.setup_model(
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/training/trainer_base.py", line 1061, in setup_model
    model = ModelFactory.create(args, checkpoint=checkpoint, tb_logger=tb_logger, gt_metadata=gt_metadata, strict=strict)
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/factory.py", line 67, in create
    model = wrapper_class(args=args, model_class=model_class, **model_kwargs)
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/xai_model.py", line 94, in __init__
    self._torch_model.build_model()
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/base.py", line 68, in build_model
    self._build_model()
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/image_base.py", line 50, in _build_model
    self.model = self.load_model(
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/models/timm_model/model.py", line 24, in load_model
    return load_model_from_online_repository(
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/utilities/general.py", line 28, in load_model_from_online_repository
    model = timm.create_model(model_name, pretrained=pretrained, num_classes=num_labels, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/timm/models/factory.py", line 71, in create_model
    raise RuntimeError('Unknown model (%s)' % model_name)
RuntimeError: Unknown model (resnet_bitv2_101x1_bitm)
{'image_attr_analysis': <class 'xai_torch.analyzer.feature_attr_analysis.image_attr_analysis.ImageAttrAnalysis'>, 'generate_metrics': <class 'xai_torch.analyzer.generate_metrics.GenerateMetrics'>}
2023-03-21 05:42:34 serv-9205 xai_torch[1097371] INFO Running task: evaluation
2023-03-21 05:42:34 serv-9205 xai_torch[1097371] INFO PyTorch version: 1.13.1+cu1160
2023-03-21 05:42:34 serv-9205 xai_torch[1097371] INFO Ignite version: 0.4.100
2023-03-21 05:42:34 serv-9205 xai_torch[1097371] INFO GPU Device: NVIDIA TITAN V
2023-03-21 05:42:34 serv-9205 xai_torch[1097371] INFO CUDA version: 11.6
2023-03-21 05:42:34 serv-9205 xai_torch[1097371] INFO CUDNN version: 8302
2023-03-21 05:42:34 serv-9205 xai_torch[1097371] INFO Initializing training script with the following arguments:
2023-03-21 05:42:34 serv-9205 xai_torch[1097371] INFO Global seed set to 42
2023-03-21 05:42:34 serv-9205 xai_torch[1097371] INFO Setting output directory: /netscratch/saifullah/xai_torch/docxai/evaluation/rvlcdip/timm_model_resnext101_32x8d
2023-03-21 05:42:34 serv-9205 xai_torch[1097371] INFO Loading data for stage == test
2023-03-21 05:42:34 serv-9205 xai_torch[1097371] INFO Loading dataset [rvlcdip-test] from cache.
2023-03-21 05:42:34 serv-9205 xai_torch[1097371] INFO [rvlcdip-test] Defining data transformations:
image:
 Compose(
    GrayScaleToRGB()
    Rescale(size=[224, 224], interpolation='bilinear', max_size=None, antialias=False)
    ConvertImageDtype()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2023-03-21 05:42:34 serv-9205 xai_torch[1097371] INFO Test set size = 39999
2023-03-21 05:42:34 serv-9205 xai_torch[1097371] INFO Testing model [baseline]
2023-03-21 05:42:34 serv-9205 xai_torch[1097371] INFO Initialized the model with data labels: ['letter', 'form', 'email', 'handwritten', 'advertisement', 'scientific report', 'scientific publication', 'specification', 'file folder', 'news article', 'budgetv', 'invoice', 'presentation', 'questionnaire', 'resume', 'memo']
2023-03-21 05:42:36 serv-9205 xai_torch[1097371] INFO Loading model from checkpoint file [/netscratch/saifullah/resources/pretrained_models/rvlcdip/resnext101_32x8d.pt] with strict [True]
checkpoint dict_keys(['state_dict'])
2023-03-21 05:42:40 serv-9205 xai_torch[1097371] INFO ======================================================================
Layer (type:depth-idx)                        Param #
======================================================================
TimmModelForImageClassification               --
├─ResNet: 1-1                                 --
│    └─Conv2d: 2-1                            9,408
│    └─BatchNorm2d: 2-2                       128
│    └─ReLU: 2-3                              --
│    └─MaxPool2d: 2-4                         --
│    └─Sequential: 2-5                        --
│    │    └─Bottleneck: 3-1                   118,784
│    │    └─Bottleneck: 3-2                   151,040
│    │    └─Bottleneck: 3-3                   151,040
│    └─Sequential: 2-6                        --
│    │    └─Bottleneck: 3-4                   602,112
│    │    └─Bottleneck: 3-5                   601,088
│    │    └─Bottleneck: 3-6                   601,088
│    │    └─Bottleneck: 3-7                   601,088
│    └─Sequential: 2-7                        --
│    │    └─Bottleneck: 3-8                   2,400,256
│    │    └─Bottleneck: 3-9                   2,398,208
│    │    └─Bottleneck: 3-10                  2,398,208
│    │    └─Bottleneck: 3-11                  2,398,208
│    │    └─Bottleneck: 3-12                  2,398,208
│    │    └─Bottleneck: 3-13                  2,398,208
│    │    └─Bottleneck: 3-14                  2,398,208
│    │    └─Bottleneck: 3-15                  2,398,208
│    │    └─Bottleneck: 3-16                  2,398,208
│    │    └─Bottleneck: 3-17                  2,398,208
│    │    └─Bottleneck: 3-18                  2,398,208
│    │    └─Bottleneck: 3-19                  2,398,208
│    │    └─Bottleneck: 3-20                  2,398,208
│    │    └─Bottleneck: 3-21                  2,398,208
│    │    └─Bottleneck: 3-22                  2,398,208
│    │    └─Bottleneck: 3-23                  2,398,208
│    │    └─Bottleneck: 3-24                  2,398,208
│    │    └─Bottleneck: 3-25                  2,398,208
│    │    └─Bottleneck: 3-26                  2,398,208
│    │    └─Bottleneck: 3-27                  2,398,208
│    │    └─Bottleneck: 3-28                  2,398,208
│    │    └─Bottleneck: 3-29                  2,398,208
│    │    └─Bottleneck: 3-30                  2,398,208
│    └─Sequential: 2-8                        --
│    │    └─Bottleneck: 3-31                  9,584,640
│    │    └─Bottleneck: 3-32                  9,580,544
│    │    └─Bottleneck: 3-33                  9,580,544
│    └─SelectAdaptivePool2d: 2-9              --
│    │    └─Flatten: 3-34                     --
│    │    └─AdaptiveAvgPool2d: 3-35           --
│    └─Linear: 2-10                           32,784
├─CrossEntropyLoss: 1-2                       --
├─CrossEntropyLoss: 1-3                       --
======================================================================
Total params: 86,775,120
Trainable params: 86,775,120
Non-trainable params: 0
======================================================================
2023-03-21 05:42:40 serv-9205 xai_torch[1097371] INFO Engine run starting with max_epochs=1.
2023-03-21 05:45:27 serv-9205 xai_torch[1097371] INFO
Epoch 1 - Evaluation time (seconds): 0.00 - test metrics:
        test/loss: 0.40997037291526794
        last/test/accuracy: 0.8984974624365609
2023-03-21 05:45:27 serv-9205 xai_torch[1097371] INFO Epoch[1] Complete. Time taken: 00:02:45.956
2023-03-21 05:45:27 serv-9205 xai_torch[1097371] INFO Engine run complete. Time taken: 00:02:46.194
{'image_attr_analysis': <class 'xai_torch.analyzer.feature_attr_analysis.image_attr_analysis.ImageAttrAnalysis'>, 'generate_metrics': <class 'xai_torch.analyzer.generate_metrics.GenerateMetrics'>}
2023-03-21 05:45:38 serv-9205 xai_torch[1097707] INFO Running task: evaluation
2023-03-21 05:45:38 serv-9205 xai_torch[1097707] INFO PyTorch version: 1.13.1+cu1160
2023-03-21 05:45:38 serv-9205 xai_torch[1097707] INFO Ignite version: 0.4.100
2023-03-21 05:45:38 serv-9205 xai_torch[1097707] INFO GPU Device: NVIDIA TITAN V
2023-03-21 05:45:38 serv-9205 xai_torch[1097707] INFO CUDA version: 11.6
2023-03-21 05:45:38 serv-9205 xai_torch[1097707] INFO CUDNN version: 8302
2023-03-21 05:45:38 serv-9205 xai_torch[1097707] INFO Initializing training script with the following arguments:
2023-03-21 05:45:38 serv-9205 xai_torch[1097707] INFO Global seed set to 42
2023-03-21 05:45:38 serv-9205 xai_torch[1097707] INFO Setting output directory: /netscratch/saifullah/xai_torch/docxai/evaluation/rvlcdip/timm_model_senet154
2023-03-21 05:45:38 serv-9205 xai_torch[1097707] INFO Loading data for stage == test
2023-03-21 05:45:38 serv-9205 xai_torch[1097707] INFO Loading dataset [rvlcdip-test] from cache.
2023-03-21 05:45:38 serv-9205 xai_torch[1097707] INFO [rvlcdip-test] Defining data transformations:
image:
 Compose(
    GrayScaleToRGB()
    Rescale(size=[224, 224], interpolation='bilinear', max_size=None, antialias=False)
    ConvertImageDtype()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2023-03-21 05:45:38 serv-9205 xai_torch[1097707] INFO Test set size = 39999
2023-03-21 05:45:38 serv-9205 xai_torch[1097707] INFO Testing model [baseline]
2023-03-21 05:45:38 serv-9205 xai_torch[1097707] INFO Initialized the model with data labels: ['letter', 'form', 'email', 'handwritten', 'advertisement', 'scientific report', 'scientific publication', 'specification', 'file folder', 'news article', 'budgetv', 'invoice', 'presentation', 'questionnaire', 'resume', 'memo']
2023-03-21 05:45:40 serv-9205 xai_torch[1097707] INFO Loading model from checkpoint file [/netscratch/saifullah/resources/pretrained_models/rvlcdip/senet154.pt] with strict [True]
checkpoint dict_keys(['state_dict'])
2023-03-21 05:45:45 serv-9205 xai_torch[1097707] INFO ======================================================================
Layer (type:depth-idx)                        Param #
======================================================================
TimmModelForImageClassification               --
├─ResNet: 1-1                                 --
│    └─Sequential: 2-1                        --
│    │    └─Conv2d: 3-1                       1,728
│    │    └─BatchNorm2d: 3-2                  128
│    │    └─ReLU: 3-3                         --
│    │    └─Conv2d: 3-4                       36,864
│    │    └─BatchNorm2d: 3-5                  128
│    │    └─ReLU: 3-6                         --
│    │    └─Conv2d: 3-7                       73,728
│    └─BatchNorm2d: 2-2                       256
│    └─ReLU: 2-3                              --
│    └─MaxPool2d: 2-4                         --
│    └─Sequential: 2-5                        --
│    │    └─Bottleneck: 3-8                   129,552
│    │    └─Bottleneck: 3-9                   112,656
│    │    └─Bottleneck: 3-10                  112,656
│    └─Sequential: 2-6                        --
│    │    └─Bottleneck: 3-11                  1,562,656
│    │    └─Bottleneck: 3-12                  447,520
│    │    └─Bottleneck: 3-13                  447,520
│    │    └─Bottleneck: 3-14                  447,520
│    │    └─Bottleneck: 3-15                  447,520
│    │    └─Bottleneck: 3-16                  447,520
│    │    └─Bottleneck: 3-17                  447,520
│    │    └─Bottleneck: 3-18                  447,520
│    └─Sequential: 2-7                        --
│    │    └─Bottleneck: 3-19                  6,242,368
│    │    └─Bottleneck: 3-20                  1,783,872
│    │    └─Bottleneck: 3-21                  1,783,872
│    │    └─Bottleneck: 3-22                  1,783,872
│    │    └─Bottleneck: 3-23                  1,783,872
│    │    └─Bottleneck: 3-24                  1,783,872
│    │    └─Bottleneck: 3-25                  1,783,872
│    │    └─Bottleneck: 3-26                  1,783,872
│    │    └─Bottleneck: 3-27                  1,783,872
│    │    └─Bottleneck: 3-28                  1,783,872
│    │    └─Bottleneck: 3-29                  1,783,872
│    │    └─Bottleneck: 3-30                  1,783,872
│    │    └─Bottleneck: 3-31                  1,783,872
│    │    └─Bottleneck: 3-32                  1,783,872
│    │    └─Bottleneck: 3-33                  1,783,872
│    │    └─Bottleneck: 3-34                  1,783,872
│    │    └─Bottleneck: 3-35                  1,783,872
│    │    └─Bottleneck: 3-36                  1,783,872
│    │    └─Bottleneck: 3-37                  1,783,872
│    │    └─Bottleneck: 3-38                  1,783,872
│    │    └─Bottleneck: 3-39                  1,783,872
│    │    └─Bottleneck: 3-40                  1,783,872
│    │    └─Bottleneck: 3-41                  1,783,872
│    │    └─Bottleneck: 3-42                  1,783,872
│    │    └─Bottleneck: 3-43                  1,783,872
│    │    └─Bottleneck: 3-44                  1,783,872
│    │    └─Bottleneck: 3-45                  1,783,872
│    │    └─Bottleneck: 3-46                  1,783,872
│    │    └─Bottleneck: 3-47                  1,783,872
│    │    └─Bottleneck: 3-48                  1,783,872
│    │    └─Bottleneck: 3-49                  1,783,872
│    │    └─Bottleneck: 3-50                  1,783,872
│    │    └─Bottleneck: 3-51                  1,783,872
│    │    └─Bottleneck: 3-52                  1,783,872
│    │    └─Bottleneck: 3-53                  1,783,872
│    │    └─Bottleneck: 3-54                  1,783,872
│    └─Sequential: 2-8                        --
│    │    └─Bottleneck: 3-55                  24,952,960
│    │    └─Bottleneck: 3-56                  7,123,072
│    │    └─Bottleneck: 3-57                  7,123,072
│    └─SelectAdaptivePool2d: 2-9              --
│    │    └─Flatten: 3-58                     --
│    │    └─AdaptiveAvgPool2d: 3-59           --
│    └─Linear: 2-10                           32,784
├─CrossEntropyLoss: 1-2                       --
├─CrossEntropyLoss: 1-3                       --
======================================================================
Total params: 113,072,768
Trainable params: 113,072,768
Non-trainable params: 0
======================================================================
2023-03-21 05:45:45 serv-9205 xai_torch[1097707] INFO Engine run starting with max_epochs=1.
2023-03-21 05:49:37 serv-9205 xai_torch[1097707] INFO
Epoch 1 - Evaluation time (seconds): 0.00 - test metrics:
        test/loss: 0.4330301582813263
        last/test/accuracy: 0.8983224580614515
2023-03-21 05:49:37 serv-9205 xai_torch[1097707] INFO Epoch[1] Complete. Time taken: 00:03:51.751
2023-03-21 05:49:37 serv-9205 xai_torch[1097707] INFO Engine run complete. Time taken: 00:03:51.973
{'image_attr_analysis': <class 'xai_torch.analyzer.feature_attr_analysis.image_attr_analysis.ImageAttrAnalysis'>, 'generate_metrics': <class 'xai_torch.analyzer.generate_metrics.GenerateMetrics'>}
2023-03-21 05:49:48 serv-9205 xai_torch[1098037] INFO Running task: evaluation
2023-03-21 05:49:48 serv-9205 xai_torch[1098037] INFO PyTorch version: 1.13.1+cu1160
2023-03-21 05:49:48 serv-9205 xai_torch[1098037] INFO Ignite version: 0.4.100
2023-03-21 05:49:48 serv-9205 xai_torch[1098037] INFO GPU Device: NVIDIA TITAN V
2023-03-21 05:49:48 serv-9205 xai_torch[1098037] INFO CUDA version: 11.6
2023-03-21 05:49:48 serv-9205 xai_torch[1098037] INFO CUDNN version: 8302
2023-03-21 05:49:48 serv-9205 xai_torch[1098037] INFO Initializing training script with the following arguments:
2023-03-21 05:49:48 serv-9205 xai_torch[1098037] INFO Global seed set to 42
2023-03-21 05:49:48 serv-9205 xai_torch[1098037] INFO Setting output directory: /netscratch/saifullah/xai_torch/docxai/evaluation/rvlcdip/timm_model_squeezenet1_0
2023-03-21 05:49:48 serv-9205 xai_torch[1098037] INFO Loading data for stage == test
2023-03-21 05:49:48 serv-9205 xai_torch[1098037] INFO Loading dataset [rvlcdip-test] from cache.
2023-03-21 05:49:48 serv-9205 xai_torch[1098037] INFO [rvlcdip-test] Defining data transformations:
image:
 Compose(
    GrayScaleToRGB()
    Rescale(size=[224, 224], interpolation='bilinear', max_size=None, antialias=False)
    ConvertImageDtype()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
2023-03-21 05:49:48 serv-9205 xai_torch[1098037] INFO Test set size = 39999
2023-03-21 05:49:48 serv-9205 xai_torch[1098037] INFO Testing model [baseline]
2023-03-21 05:49:48 serv-9205 xai_torch[1098037] INFO Initialized the model with data labels: ['letter', 'form', 'email', 'handwritten', 'advertisement', 'scientific report', 'scientific publication', 'specification', 'file folder', 'news article', 'budgetv', 'invoice', 'presentation', 'questionnaire', 'resume', 'memo']
ERROR:root:Unknown model (squeezenet1_0)
Traceback (most recent call last):
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/analyzer/analyzer.py", line 56, in run
    cls.analyze(args)
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/analyzer/analyzer.py", line 40, in analyze
    task.run()
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/analyzer/generate_metrics.py", line 65, in run
    model = self._trainer_base.setup_model(
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/training/trainer_base.py", line 1061, in setup_model
    model = ModelFactory.create(args, checkpoint=checkpoint, tb_logger=tb_logger, gt_metadata=gt_metadata, strict=strict)
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/factory.py", line 67, in create
    model = wrapper_class(args=args, model_class=model_class, **model_kwargs)
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/xai_model.py", line 94, in __init__
    self._torch_model.build_model()
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/base.py", line 68, in build_model
    self._build_model()
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/image_base.py", line 50, in _build_model
    self.model = self.load_model(
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/models/timm_model/model.py", line 24, in load_model
    return load_model_from_online_repository(
  File "/home/saifullah/projects/docxai/external/xai_torch/src/xai_torch/core/models/utilities/general.py", line 28, in load_model_from_online_repository
    model = timm.create_model(model_name, pretrained=pretrained, num_classes=num_labels, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/timm/models/factory.py", line 71, in create_model
    raise RuntimeError('Unknown model (%s)' % model_name)
RuntimeError: Unknown model (squeezenet1_0)
root@serv-9205:/home/saifullah/projects/docxai# ./scripts/experiments/evaluate_all.sh ^C
root@serv-9205:/home/saifullah/projects/docxai# ^C
root@serv-9205:/home/saifullah/projects/docxai# exit
srun: error: serv-9205: task 0: Exited with exit code 130
srun: launch/slurm: _step_signal: Terminating StepId=584037.0